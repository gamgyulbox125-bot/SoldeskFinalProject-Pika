<div class="review-form-container" th:fragment="reviewForm(productId, sellerId)">
    <h1>새 리뷰 작성</h1>

    <p th:if="${errorMessage}" class="error-message" th:text="${errorMessage}"></p>

    <form th:action="${reviewId != null} ? @{/reviews/{reviewId}(reviewId=${reviewId})} : @{/reviews(productId=${productId})}"
          th:object="${review}"
          method="post">
        <input type="hidden" th:if="${reviewId != null}" name="_method" value="put" />
        <input type="hidden" th:if="${reviewId != null}" name="reviewId" th:value="${reviewId}" />
        <input type="hidden" name="productId" th:value="${productId}" />
        <input type="hidden" name="sellerId" th:value="${sellerId}" />
        <div>
            <label for="sellerNickname">판매자:</label>
            <input type="text" id="sellerNickname" th:value="${sellerNickname}" readonly>
        </div>
        <!-- user_id는 Principal에서 가져오므로 폼에 노출하지 않음 -->
        <div>
            <label for="score">별점 (1-5):</label>
            <input type="number" id="score" th:field="*{score}" min="1" max="5" required>
        </div>
        <div>
            <label for="content">리뷰 내용:</label>
            <textarea id="content" th:field="*{content}" rows="3" cols="30" maxlength="1000"></textarea>
        </div>
        <div>
            <input type="submit" value="리뷰 제출">
        </div>
    </form>

    <hr/>
    <a th:href="@{/reviews/seller/{sellerId}(sellerId=${sellerId})}">리뷰 목록으로 돌아가기</a>
    <br/>
    <a href="/">홈으로 돌아가기</a>
</div>